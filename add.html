<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.css" />
    <link href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css" rel="stylesheet">
    <link href="https://unpkg.com/gijgo@1.9.13/css/gijgo.min.css" rel="stylesheet" type="text/css" />
    
    <title>Add Book</title>
    <style>
    .container {
    max-width: 700px;
    margin: 80px auto;
    padding: 50px;
    box-shadow: 0px 0px 8px 1px #c1c1c1;
    border-radius: 8px;
    position: relative;
    }
    .dropdown {
    display: block !important;
    width: 100% !important;
    }
    .btn-light {
    color: #212529;
    background-color: white;
    border-color: #ced4da;
    }
    .custom-control {
    display: inline-block !important;
    }
    .toggle-off {
    white-space: nowrap;
    }
    .form-group {
    margin-bottom: 1.3rem;
    }
    .custom-control {
    margin-right: 15px;
    }
    .header {
    position: absolute;
    width: 100%;
    height: 70px;
    background-color: #007bff!important;
    top: 0;
    left: 0;
    border-top-left-radius: 8px;
    border-top-right-radius: 8px;
    }
    .main {
    padding-top: 50px;
    }
    .header h1 {
    text-align: center;
    color: white;
    padding: 10px 0px;
    }
    .btn-success:not(:disabled):not(.disabled).active, .btn-success:not(:disabled):not(.disabled):active, .show>.btn-success.dropdown-toggle {
    color: #fff;
    background-color: #007bff;
    border-color: #007bff;
    }
    .btn-info, .btn-success,  .btn-success:hover {
    color: #fff;
    background-color: #007bff;
    border-color: #007bff;
    }
    .center-align {
    text-align: center;
    }

    .error
   {
    color:red;
    font-size: 12px;
   }
    </style>
  </head>
  <body>
    <div class="container">
        <div class="header">
          <h1>Add Book</h1>
        </div>
        <div class="main">
      <form>
        <div class="form-group">
          <label for="bookName">Book Name</label>
          <input type="text" class="form-control" id="bookName" placeholder="Enter Book Name" onkeyup="errorClear('bookName')" />
           <p class="error" id="bookNameError"></p>
        </div>
        <div class="form-group">
          <label for="authorEmail">Author Email</label>
          <input type="text" class="form-control" id="authorEmail" placeholder="Enter Author Email" onkeyup="errorClear('authorEmail')" />
          <p class="error" id="authorEmailError"></p>
        </div>
        <div class="form-group">
          <label for="website">Website</label>
          <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">https://www.</span>
          </div>
          <input type="text" class="form-control" id="website" placeholder=" Enter Website" onkeyup="errorClear('website')" />
          
        </div>
        <p class="error" id="websiteError"></p>
        </div>
        <div class="form-group">
          <label style="display: block" class="my-1 mr-2" for="inlineFormCustomSelectPref">Cover Picture</label>
          <input type="file"  id="imgupload" onchange="readURL(this)" style="display:none" onclick="errorClear('upload')"/>
          <button type="button" id="upload" class="btn btn-primary">Upload</button>
          <p class="error" id="uploadError"></p>
          <!-- <img id="previewUpload" src="#" alt="your image" /> -->
        </div>
        <div class="form-group">
          <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Categories (Multi-select Dropdown)</label>
          <select class="selectpicker" id="category" multiple data-live-search="true" onchange="errorClear('category')">
            <option value="Romance" >Romance</option>
            <option value="Suspense" >Suspense </option>
            <option value="Thriller">Thriller</option>
          </select>
          <p class="error" id="categoryError"></p>
        </div>
        <div class="form-group">
          <label class="my-1 mr-2" for="inlineFormCustomSelectPref">Date Of Publication</label>
          <input id="datepicker" width="100%" onchange="errorClear('datepicker')" />
          <p class="error" id="datepickerError"></p>
        </div>
        <div class="form-group"></div>
        <div class="form-row">
          <div class="col">
            <div class="form-group">
              <label for="isbn">ISBN Number</label>
              <input type="text" class="form-control" id="isbn" placeholder="Enter ISBN Number" onkeyup="errorClear('isbn')" />
              <p class="error" id="isbnError"></p>
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <label for="price">Price</label>
              <div class="input-group">
                <div class="input-group-prepend">
                  <span class="input-group-text">&#8377</span>
                </div>
                <input type="text" id="price" class="form-control" aria-label="Amount (to the nearest dollar)" onkeyup="errorClear('price')" />
                
              </div>
              <p class="error" id="priceError"></p>
            </div>
          </div>
        </div>
        <div class="form-group">
          <label class="my-1 mr-2" for="type">Type</label>
          <select class="custom-select my-1 mr-sm-2" id="type" onchange="errorClear('type')">
            <option value="0" selected disabled>Choose...</option>
            <option value="Magazine">Magazine</option>
            <option value="Magazine">Novel</option>
            <option value="Magazine">Textbook</option>
          </select>
          <p class="error" id="typeError"></p>
        </div>
        <div class="form-group " >
          <label style="display: block" class="my-1 mr-2" for="inlineFormCustomSelectPref">Format</label>
          <div class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input checkbox" value="Paperback" id="customCheck1" onclick="errorClear('format')">
            <label class="custom-control-label format"  for="customCheck1">Paperback</label>
          </div>
          <div class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input checkbox" value="Hardback" id="customCheck2" onclick="errorClear('format')">
            <label class="custom-control-label format" for="customCheck2">Hardback</label>
          </div>
          <div class="custom-control custom-checkbox ">
            <input type="checkbox" class="custom-control-input checkbox" value="ebook" id="customCheck3" onclick="errorClear('format')">
            <label class="custom-control-label format" for="customCheck3">ebook</label>
          </div>
          <p class="error" id="formatError"></p>
        </div>
        <div class="form-group ">
          <label style="display: block" class="my-1 mr-2" for="inlineFormCustomSelectPref">In Stock</label>
          <input type="checkbox" id="stock" checked data-toggle="toggle" data-on="Available" data-off="Out Of Stock"
            data-onstyle="success" data-offstyle="danger" data-height="30" onchange="errorClear('stock')">
        </div>
        <div class="form-group">
          <label style="display: block" class="my-1 mr-2" for="inlineFormCustomSelectPref">Rating</label>
          <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="customRadioInline1" name="customRadioInline1" value="1" class="custom-control-input radio" onchange="errorClear('rating')" >
            <label class="custom-control-label" for="customRadioInline1">1</label>
          </div>
          <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="customRadioInline2" name="customRadioInline1" value="2" class="custom-control-input radio" onchange="errorClear('rating')">
            <label class="custom-control-label" for="customRadioInline2">2</label>
          </div>
          <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="customRadioInline3" name="customRadioInline1" value="3" class="custom-control-input radio" onchange="errorClear('rating')">
            <label class="custom-control-label" for="customRadioInline3">3</labl>
          </div>
          <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="customRadioInline4" name="customRadioInline1" value="4" class="custom-control-input radio" onchange="errorClear('rating')">
            <label class="custom-control-label" for="customRadioInline4">4</labl>
          </div>
          <div class="custom-control custom-radio custom-control-inline">
            <input type="radio" id="customRadioInline5" name="customRadioInline1" value="5" class="custom-control-input radio" onchange="errorClear('rating')">
            <label class="custom-control-label" for="customRadioInline5">5</labl>
          </div>
          <p class="error" id="ratingError"></p>
        </div>
        <div class="form-group">
          <label for="comment">Review</label>
          <textarea class="form-control" rows="5" id="comment" onkeyup="errorClear('comment')"></textarea>
          <p class="error" id="commentError"></p>
        </div>
        <div class="form-group">
        <div class="center-align">
          <button type="button" class="btn btn-primary" onclick="preview()" >Preview</button>
          <button type="button" class="btn btn-danger">Cancel</button>
        </div>
      </div>
      </form>
    </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>
    <script src="https://unpkg.com/gijgo@1.9.13/js/gijgo.min.js" type="text/javascript"></script>
    <script>
      $('#datepicker').datepicker({
            uiLibrary: 'bootstrap4'
        });

      $('#upload').click(function(){ 
          $('#imgupload').trigger('click'); 
        });

      var coverImage = false;
      var path = null;
       //email validation
       function validateEmail(email) {
        var re = /^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
        return re.test(email);
      }

       //price validation
       function validatePrice(price)
      {
        var re = /^\d+$/;
        return re.test(price);
      }

        //ISBN validation
        function validateISBN(isbn)
      {
        var re = /[0-9]{3}[-][0-9]{1}[-][0-9]{5}[-][0-9]{3}[-][0-9]{1}/;
        return re.test(isbn);
      }
        
      function readURL(input)
      {
  
        if (input.files && input.files[0]) {
        if(input.files[0].size > 2000000)
        {
          // document.getElementById("upload").style.border = "1px solid red";
          document.getElementById("uploadError").innerHTML = "Max file size 2MB";
        }
       else if(input.files[0].name.split('.').pop().toLowerCase() != "png" && input.files[0].name.split('.').pop().toLowerCase() != "jpg" )
        {
          document.getElementById("uploadError").innerHTML = "Format supported jpg/png";
        }
        else if(input.files[0].size > 2000000 && input.files[0].name.split('.').pop().toLowerCase() != "png" && input.files[0].name.split('.').pop().toLowerCase() != "jpg" )
        {
          document.getElementById("uploadError").innerHTML = "Max file size 2MB jpg/png";
        }
        else{
          coverImage = true;
          var reader = new FileReader();
       
        reader.onload = function (e) {
          path = e.target.result;
        }
        reader.readAsDataURL(input.files[0]);
        }
          
        }
      }
        function preview()
        {
          var category = [];
          var format = [];
          var rating = [];
          var stock = null;

           var bookName = document.getElementById("bookName").value;
           var authorEmail = document.getElementById("authorEmail").value;
           var website = document.getElementById("website").value;
           var datepicker = document.getElementById("datepicker").value;
           var isbn = document.getElementById("isbn").value;
           var price = document.getElementById("price").value;
           var type = document.getElementById("type").value;
           var comment = document.getElementById("comment").value;

            for(options of document.getElementById("category").options)
            {
              if(options.selected) //returns true or false
              {
                category.push(options.value);
              }
            }

          
            var checkboxs = document.getElementsByClassName("checkbox");
            for(var i=0;i<checkboxs.length;i++)
            {
              if(checkboxs[i].checked)
              {
                format.push(checkboxs[i].value);
              }
            }

            var stockVal = document.getElementById("stock").checked;
            if(stockVal)
            {
             stock = "Available";
            }
            else
            {
              stock = "Not available";
            }

            var radios = document.getElementsByClassName("radio");
            for(var i=0;i<radios.length;i++)
            {
              if(radios[i].checked)
              {
                rating.push(radios[i].value);
              }
            }

            if(bookName == "")
            {
             document.getElementById("bookName").style.border = "1px solid red";
             document.getElementById("bookNameError").innerHTML = "Enter book name";
            }

            if(authorEmail == "" )
            {
              document.getElementById("authorEmail").style.border = "1px solid red";
              document.getElementById("authorEmailError").innerHTML = "Enter email";
            }
            else{
             
              if(!validateEmail(authorEmail))
              {
              document.getElementById("authorEmail").style.border = "1px solid red";
              document.getElementById("authorEmailError").innerHTML = "Enter valid email";
              }
            }

            if(website == "")
            {
             document.getElementById("website").style.border = "1px solid red";
             document.getElementById("websiteError").innerHTML = "Enter website link";
            }
           
            

            if(datepicker == "" )
            {
              document.getElementById("datepicker").style.border = "1px solid red";
             document.getElementById("datepickerError").innerHTML = "Select date";
            }

            if(type == "0")
            {
              document.getElementById("type").style.border = "1px solid red";
             document.getElementById("typeError").innerHTML = "Select type";
            }

            if(isbn == "" )
            {
              document.getElementById("isbn").style.border = "1px solid red";
             document.getElementById("isbnError").innerHTML = "Enter ISBN number";
            }
            else{
              
              if(!validateISBN(isbn))
              {
                document.getElementById("isbn").style.border = "1px solid red";
                document.getElementById("isbnError").innerHTML = "Enter valid ISBN number";
              }
            }

            if(price == "")
            {
              document.getElementById("price").style.border = "1px solid red";
              document.getElementById("priceError").innerHTML = "Enter price";
            }
            else{
              
              if(!validatePrice(price))
              {
                document.getElementById("price").style.border = "1px solid red";
                document.getElementById("priceError").innerHTML = "Enter valid price";
              }
            }


            if( category.length == 0 )
            {
             document.getElementById("categoryError").innerHTML = "Select categories";
            }

            if(format.length == 0 )
            {
             document.getElementById("formatError").innerHTML = "Select format";
            }

            if(rating.length == 0)
            {
             document.getElementById("ratingError").innerHTML = "Choose rating";
            }

            if(comment == "")
            {
              document.getElementById("comment").style.border = "1px solid red";
             document.getElementById("commentError").innerHTML = "Enter comment";
            }

            if(coverImage == false)
            {
             document.getElementById("uploadError").innerHTML = "Select image";
            }
            

            if(bookName != "" && 
            authorEmail != "" && 
            validateEmail(authorEmail) && 
            website != "" && 
            datepicker != "" && 
            type != "0" && 
            isbn != "" && 
            validateISBN(isbn) &&
            price != "" && 
            validatePrice(price) &&
            category.length != 0 && 
            format.length != 0 && 
            rating.length != 0 && 
            coverImage == true && 
            comment != "" &&
            stock != null)
            {
              datepicker = new Date(datepicker);
              var month = new Array();
              month[0] = "January";
              month[1] = "February";
              month[2] = "March";
              month[3] = "April";
              month[4] = "May";
              month[5] = "June";
              month[6] = "July";
              month[7] = "August";
              month[8] = "September";
              month[9] = "October";
              month[10] = "November";
              month[11] = "December";

              var date = datepicker.getDate()+"/"+month[datepicker.getMonth()]+"/"+datepicker.getFullYear();
              sessionStorage.setItem('bookName',bookName);
              sessionStorage.setItem('authorEmail',authorEmail);
              sessionStorage.setItem('website',website);
              sessionStorage.setItem('datepicker',date);
              sessionStorage.setItem('category',category);
              sessionStorage.setItem('type',type);
              sessionStorage.setItem('isbn',isbn);
              sessionStorage.setItem('price',price);
              sessionStorage.setItem('format',format);
              sessionStorage.setItem('rating',rating);
              sessionStorage.setItem('rating',rating);
              sessionStorage.setItem('comment',comment);
              sessionStorage.setItem('stock',stock);
              sessionStorage.setItem('path',path);
              window.location.href="preview.html";
            }
            
        }

        function errorClear(field)
        {
           if(field == "bookName")
           {
            document.getElementById("bookName").style.border = "1px solid #ced4da";
            document.getElementById("bookNameError").innerHTML = "";
           }
           else if(field == "authorEmail")
           {
            document.getElementById("authorEmail").style.border = "1px solid #ced4da";
            document.getElementById("authorEmailError").innerHTML = "";
           }
           else if(field == "website")
           {
            document.getElementById("website").style.border = "1px solid #ced4da";
            document.getElementById("websiteError").innerHTML = "";
           }
           else if(field == "upload")
           {
            document.getElementById("upload").style.border = "1px solid #ced4da";
            document.getElementById("uploadError").innerHTML = "";
           }
           else if(field == "datepicker")
           {
            document.getElementById("datepicker").style.border = "1px solid #ced4da";
            document.getElementById("datepickerError").innerHTML = "";
           }
           else if(field == "type")
           {
            document.getElementById("type").style.border = "1px solid #ced4da";
            document.getElementById("typeError").innerHTML = "";
           }
           else if(field == "isbn")
           {
            document.getElementById("isbn").style.border = "1px solid #ced4da";
            document.getElementById("isbnError").innerHTML = "";
           }
           else if(field == "price")
           {
            document.getElementById("price").style.border = "1px solid #ced4da";
            document.getElementById("priceError").innerHTML = "";
           }
           else if(field == "category")
           {
            document.getElementById("category").style.border = "1px solid #ced4da";
            document.getElementById("categoryError").innerHTML = "";
           }
           else if(field == "format")
           {
           var formatSelected = document.getElementsByClassName("checkbox");
              for(var i=0;i<formatSelected.length;i++)
            {
              if(formatSelected[i].checked)
              {
                document.getElementById("formatError").innerHTML = "";
              }
            }
           
           }
           else if(field == "rating")
           {
            var ratingSelected = document.getElementsByClassName("radio");
              for(var i=0;i<ratingSelected.length;i++)
            {
              if(ratingSelected[i].checked)
              {
                document.getElementById("ratingError").innerHTML = "";
              }
            }
           
           }
           else if(field == "comment")
           {
            document.getElementById("comment").style.border = "1px solid #ced4da";
            document.getElementById("commentError").innerHTML = "";
           }
        }


    </script>
  </body>
</html>
